<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Download Modbus List and MIB </title>

    <style>
        .main {
            display: flex;
            height: 100vh;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>
<div class="main">
    <p>
    <input type="button" id="download_modbus_list" onclick="downloadMobusList()" value="Download Modbus List">
    <br>
    <br>
    <br>
    <br>
    <input type="button" id="download_mib_list" onclick="downloadMIBList()" value="Download MIB List">
    <p>
</div>

<script src="static/axios.min.js"></script>
<script>
    const inputButtonModbus = document.getElementById("download_modbus_list")
    const inputButtonMIB = document.getElementById("download_mib_list")

    const downloadMobusList = () => {
        inputButtonModbus.disabled = true
        return axios({
            method: 'post',
            url: '/modbus',
            data: {
                text: "test"
            }, responseType: 'blob'
        })
            .then(response => downloadFile_Modbus(response.data))
            .catch(error => console.error(error))
            .finally(() => {
                inputButtonModbus.disabled = false
            })
    }

    const downloadMIBList = () => {
        inputButtonMIB.disabled = true
        return axios({
            method: 'post',
            url: '/MIB',
            data: {
                text: "test"
            }, responseType: 'blob'
        })
            .then(response => downloadFile_MIB(response.data))
            .catch(error => console.error(error))
            .finally(() => {
                inputButtonMIB.disabled = false
            })
    }

    const downloadFile_Modbus = (data) => {
        const url = window.URL.createObjectURL(new Blob([data]));
        const link = document.createElement('a');
        link.href = url;
        link.setAttribute('download', `modbus_list.json`);
        document.body.appendChild(link);
        link.click();
    }

    const downloadFile_MIB = (data) => {
        const url = window.URL.createObjectURL(new Blob([data]));
        const link = document.createElement('a');
        link.href = url;
        link.setAttribute('download', `mib_list.mib`);
        document.body.appendChild(link);
        link.click();
    }

</script>

</body>
</html>